{% set peer_order = peer.peer_order | int %}
{% set order = wireguard_self_order | int %}

[Interface]
PrivateKey = {{ wireguard_private_key }}
ListenPort = {{ 30000 + peer_order }}
Table = off
PostUp = ip addr add {{ inter_node_lla_prefix }}{{ order }}/64 dev %i

[Peer]
PublicKey = {{ peer.public_key }}
Endpoint = {{ peer.endpoint_host }}:{{ 30000 + order }}
AllowedIPs = {{ wireguard_allowed_ips | join(', ') }}
{% if wireguard_keepalive | default(0) | int > 0 %}
PersistentKeepalive = {{ wireguard_keepalive | int }}
{% endif %}